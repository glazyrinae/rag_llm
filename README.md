# RAG LLM ‚Äî Retrieval-Augmented –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –ø–æ –∫–æ–¥—É –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

---

## –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ

- [–û –ø—Ä–æ–µ–∫—Ç–µ](#–æ-–ø—Ä–æ–µ–∫—Ç–µ)
- [–ö–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏](#–∫–ª—é—á–µ–≤—ã–µ-–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏)
- [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)
- [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è)
- [–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã](#–æ—Å–Ω–æ–≤–Ω—ã–µ-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã)
- [–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è](#–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ-–æ–∫—Ä—É–∂–µ–Ω–∏—è-–∏-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)
- [–ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker Compose](#–∑–∞–ø—É—Å–∫-—á–µ—Ä–µ–∑-docker-compose)
- [–õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫](#–ª–æ–∫–∞–ª—å–Ω—ã–π-–∑–∞–ø—É—Å–∫)
- [–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ API –∏ –æ—á–µ—Ä–µ–¥–µ–π](#–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ-api-–∏-–æ—á–µ—Ä–µ–¥–µ–π)
- [–¢–µ–ª–µ–≥—Ä–∞–º-–±–æ—Ç](#—Ç–µ–ª–µ–≥—Ä–∞–º-–±–æ—Ç)
- [–û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è](#–æ–±—Ä–∞–±–æ—Ç–∫–∞-–¥–∞–Ω–Ω—ã—Ö-–∏-–∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è)
- [–ö–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è](#–∫–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è)
- [–¢—Ä–æ–±–ª—à—É—Ç–∏–Ω–≥](#—Ç—Ä–æ–±–ª—à—É—Ç–∏–Ω–≥)
- [FAQ](#faq)

---

## –û –ø—Ä–æ–µ–∫—Ç–µ

**RAG LLM** ‚Äî —Å–µ—Ä–≤–µ—Ä–Ω–æ-–±–æ—Ç–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞, –æ–±—ä—è—Å–Ω–µ–Ω–∏—è –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∫–æ–¥–∞. –í –µ–µ –æ—Å–Ω–æ–≤–µ Retrieval-Augmented Generation: –∫–æ–¥–æ–≤—ã–µ –∏ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã –∏–Ω–¥–µ–∫—Å–∏—Ä—É—é—Ç—Å—è, –ø–æ–ø–∞–¥–∞—é—Ç –≤ Qdrant, –∞ –∑–∞—Ç–µ–º –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –ø–æ–¥—Å–∫–∞–∑–æ–∫ –∏–ª–∏ –æ—Ç–≤–µ—Ç–æ–≤ LLM. –†–µ—à–µ–Ω–∏–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è:

- –∞–Ω–∞–ª–∏–∑–∞ —Å—Ç–æ—Ä–æ–Ω–Ω–∏—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤ –∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤;
- –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –∏ —Ä–µ–≤—å—é;
- –ø–æ–º–æ—â–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞–º –≤ –Ω–æ–≤–æ–º –ø—Ä–æ–µ–∫—Ç–µ;
- –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è —á–∞—Ç-–±–æ—Ç–æ–≤ –ø–æ–≤–µ—Ä—Ö –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ –∫–æ–¥–∞.

–°–∏—Å—Ç–µ–º–∞ —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç—Å—è –ø–æ–ª–Ω–æ—Å—Ç—å—é –ª–æ–∫–∞–ª—å–Ω–æ (FastAPI, Redis, Qdrant, Ollama) –∏–ª–∏ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ –æ–±–ª–∞—á–Ω–æ–π –º–æ–¥–µ–ª–∏ —á–µ—Ä–µ–∑ OpenRouter. –î–ª—è –æ–±—â–µ–Ω–∏—è —Å –∫–æ–Ω–µ—á–Ω—ã–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –ø—Ä–µ–¥—É—Å–º–æ—Ç—Ä–µ–Ω Telegram-–±–æ—Ç.

---

## –ö–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **–ú—É–ª—å—Ç–∏—Ñ–æ—Ä–º–∞—Ç–Ω–∞—è –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è.** –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è `.py`, `.md`, `.txt`, `.pdf`, `.html`; Python-—Ñ–∞–π–ª—ã –∞–Ω–∞–ª–∏–∑–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ AST –∏ —Ä–∞–∑–±–∏—Ä–∞—é—Ç—Å—è –Ω–∞ –∫–ª–∞—Å—Å—ã/—Ñ—É–Ω–∫—Ü–∏–∏, Markdown ‚Äî –Ω–∞ —Ä–∞–∑–¥–µ–ª—ã –∏ –±–ª–æ–∫–∏ –∫–æ–¥–∞.
- **–í–µ–∫—Ç–æ—Ä–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ Qdrant.** –≠–º–±–µ–¥–¥–∏–Ω–≥–∏ (`sentence-transformers/all-mpnet-base-v2`) —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –∫–æ–ª–ª–µ–∫—Ü–∏—é `knowledge base` –∏ –¥–æ—Å—Ç—É–ø–Ω—ã –∫–∞–∫ —á–µ—Ä–µ–∑ API, —Ç–∞–∫ –∏ –Ω–∞–ø—Ä—è–º—É—é.
- **–î–∏–∞–ª–æ–≥–æ–≤—ã–π RAG.** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `ConversationalRetrievalChain` c `ConversationBufferWindowMemory`: –æ—Ç–≤–µ—Ç—ã —É—á–∏—Ç—ã–≤–∞—é—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤.
- **–û—á–µ—Ä–µ–¥—å –∑–∞–¥–∞—á.** –°–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –±—Ä–æ–∫–µ—Ä –Ω–∞ Redis (`app/lib/queue.py`) —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –≤ –≤–æ—Ä–∫–µ—Ä—ã. –ú–æ–∂–Ω–æ –≤—ã—Å—Ç–∞–≤–ª—è—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ—Ä–∫–µ—Ä–æ–≤, —Ä–µ—Ç—Ä–∞–∏, –æ—Ç–ª–æ–∂–µ–Ω–Ω—ã–π —Å—Ç–∞—Ä—Ç.
- **–ì–∏–±–∫–∞—è LLM.** –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ–µ (—á–µ—Ä–µ–∑ Ollama) –∏ –æ–±–ª–∞—á–Ω–æ–µ (ChatOpenAI + OpenRouter) –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ; –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–¥–µ–ª–∏ –∑–∞–¥–∞—é—Ç—Å—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è.
- **Telegram-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è.** Aiogram-–±–æ—Ç –ø–µ—Ä–µ—Å—ã–ª–∞–µ—Ç –≤–æ–ø—Ä–æ—Å—ã –≤ API, –∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—á–µ—Ä–µ–¥–∏ (`rag_adapter`) –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—Ç–≤–µ—Ç—ã –Ω–∞–ø—Ä—è–º—É—é –≤ —á–∞—Ç.
- **Docker-first.** –í `docker-compose.yml` –æ–ø–∏—Å–∞–Ω—ã –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã: API, worker, Qdrant, Redis, Ollama, Open-WebUI, Telegram-–±–æ—Ç. –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –æ–¥–Ω–æ–≥–æ `docker-compose up`.

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ FastAPI /app/main.py‚îÇ        ‚îÇ Queue Worker manage.py ‚îÇ
‚îÇ  /api/endpoints.py  ‚îÇ        ‚îÇ rag_adapter.rag_ask_llm‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
          ‚îÇ                                    ‚îÇ
          ‚îÇ Redis Queue (lib.queue.QueueManager)‚îÇ
          ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                 ‚îÇ
                   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                   ‚îÇ        Rag –∫–ª–∞—Å—Å          ‚îÇ
                   ‚îÇ embeddings + Qdrant       ‚îÇ
                   ‚îÇ ConversationalRetrievalChain‚îÇ
                   ‚îî‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                       ‚îÇ
         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
         ‚îÇ Qdrant (–≤–µ–∫—Ç–æ—Ä–∞ + –º–µ—Ç–∞)   ‚îÇ      ‚îÇ LLM (Ollama/OpenRouter) ‚îÇ
         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                       ‚îÇ                               ‚îÇ
                       ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                       ‚îÇ
                          ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                          ‚îÇTelegram bot (aiogram)   ‚îÇ
                          ‚îÇbot/main.py              ‚îÇ
                          ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```
rag_llm/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ api/                  # FastAPI endpoints –∏ –æ—á–µ—Ä–µ–¥—å
‚îÇ   ‚îú‚îÄ‚îÄ lib/                  # RAG, –æ—á–µ—Ä–µ–¥–∏, –ø–∞—Ä—Å–µ—Ä—ã —Ñ–∞–π–ª–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ services/             # DI –∏ –∞–¥–∞–ø—Ç–µ—Ä—ã –æ—á–µ—Ä–µ–¥–∏
‚îÇ   ‚îú‚îÄ‚îÄ data/                 # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –ø—Ä–æ–µ–∫—Ç—ã –¥–ª—è –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ embedding_models/     # –ö—ç—à –º–æ–¥–µ–ª–µ–π HF (volume)
‚îÇ   ‚îú‚îÄ‚îÄ main.py               # –°–æ–∑–¥–∞–Ω–∏–µ FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ manage.py             # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –≤–æ—Ä–∫–µ—Ä–∞
‚îú‚îÄ‚îÄ bot/                      # Telegram –±–æ—Ç (aiogram)
‚îÇ   ‚îú‚îÄ‚îÄ deploy/               # Dockerfile + requirements
‚îÇ   ‚îî‚îÄ‚îÄ main.py
‚îú‚îÄ‚îÄ deploy/                   # Docker-—Ñ–∞–π–ª—ã –∏ volume –∫–∞—Ç–∞–ª–æ–≥–∏
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile            # –û–±—Ä–∞–∑ –¥–ª—è api/worker
‚îÇ   ‚îú‚îÄ‚îÄ requirements.txt
‚îÇ   ‚îî‚îÄ‚îÄ */                    # data, embedding_models, qdrant_data –∏ –¥—Ä.
‚îú‚îÄ‚îÄ docker-compose.yml
‚îî‚îÄ‚îÄ README.md
```

---

## –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –§–∞–π–ª/–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|-----------|-----------------|------------|
| FastAPI API | `app/main.py`, `app/api/endpoints.py` | REST-—ç–Ω–¥–ø–æ–∏–Ω—Ç—ã (`/api/ask_test`, `/api/ask`, `/api/index-local-project`, `/api/health`). –ü–æ–¥–∫–ª—é—á–∞–µ—Ç DI –¥–ª—è Rag –∏ –æ—á–µ—Ä–µ–¥—å. |
| –û—á–µ—Ä–µ–¥—å | `app/lib/queue.py`, `app/api/queue.py` | –û—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –ø–æ—Å—Ç–∞–Ω–æ–≤–∫—É –∑–∞–¥–∞—á –≤ Redis, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–æ—Ä–∫–µ—Ä–∞–º–∏, –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏, —Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤. |
| –í–æ—Ä–∫–µ—Ä—ã | `app/manage.py`, `services/rag_adapter.py` | –ö—Ä—É—Ç—è—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ –æ—Ç API, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç –æ—á–µ—Ä–µ–¥—å `rag_questions`, –≤—ã–∑—ã–≤–∞—é—Ç Rag –∏ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç –æ—Ç–≤–µ—Ç –≤ Telegram. |
| –ö–ª–∞—Å—Å Rag | `app/lib/rag.py` | –•—Ä–∞–Ω–∏—Ç LLM, Retriever, –ø–∞–º—è—Ç—å, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã, –∏–Ω–¥–µ–∫—Å–∏—Ä—É–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç—ã, —É–ø—Ä–∞–≤–ª—è–µ—Ç Qdrant. |
| –ü–∞—Ä—Å–µ—Ä —Ñ–∞–π–ª–æ–≤ | `app/lib/file_processor.py` | –ü—Ä–µ–≤—Ä–∞—â–∞–µ—Ç –ª—é–±—ã–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–∞–π–ª—ã –≤ `langchain.schema.Document` —Å –±–æ–≥–∞—Ç—ã–º–∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏. |
| Telegram –±–æ—Ç | `bot/main.py` | –ü—Ä–∏–Ω–∏–º–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –≤ API –∏ –ø–µ—Ä–µ—Å—ã–ª–∞–µ—Ç –æ—Ç–≤–µ—Ç—ã. |
| Docker –æ–∫—Ä—É–∂–µ–Ω–∏–µ | `docker-compose.yml`, `deploy/*`, `bot/deploy/*` | –°–±–æ—Ä–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤, —Å–æ–∑–¥–∞–Ω–∏–µ volume'–æ–≤ –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π, –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Ollama, Open-WebUI, Qdrant, Redis. |

---

## –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –û—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–∏—Å (`.env`)

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|------------|-----------|
| `OPENROUTER_API_KEY` | –¢–æ–∫–µ–Ω OpenRouter (–æ–±—è–∑–∞—Ç–µ–ª–µ–Ω –¥–ª—è –æ–±–ª–∞—á–Ω–æ–≥–æ LLM). |
| `TYPE_MODEL` | `cloud` (ChatOpenAI + OpenRouter) –∏–ª–∏ `local` (Ollama). |
| `QDRANT_HOST`, `QDRANT_PORT` | –ù–∞—Å—Ç—Ä–æ–π–∫–∏ Qdrant –∫–ª–∏–µ–Ω—Ç–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `qdrant:6333` –≤ Docker). |
| `QDRANT__SERVICE__HTTP_PORT` | –ü–æ—Ä—Ç Qdrant, –ø—Ä–æ–±—Ä–∞—Å—ã–≤–∞–µ–º—ã–π –Ω–∞—Ä—É–∂—É (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `docker-compose.yml`). |
| `UID`, `GID` | UID/GID —Ö–æ—Å—Ç-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è; –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è —Å —ç—Ç–∏–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏, —á—Ç–æ–±—ã —Ñ–∞–π–ª—ã –≤ volume –∏–º–µ–ª–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –ø—Ä–∞–≤–∞. |
| `BOT_TOKEN` | –¢–æ–∫–µ–Ω Telegram-–±–æ—Ç–∞ (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–æ—Ä–∫–µ—Ä–æ–º –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –æ—Ç–≤–µ—Ç–æ–≤). |

### Telegram –±–æ—Ç (`bot/.env`)

–ú–∏–Ω–∏–º–∞–ª—å–Ω–æ —Ç—Ä–µ–±—É–µ—Ç—Å—è `BOT_TOKEN`. –ï—Å–ª–∏ –±–æ—Ç—É –Ω—É–∂–Ω–æ –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ API –∑–∞ –ø—Ä–µ–¥–µ–ª–∞–º–∏ docker-compose, —É–∫–∞–∂–∏—Ç–µ `API_BASE_URL`.

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

- –ü—É—Ç—å –∫ –∫—ç—à—É –º–æ–¥–µ–ª–µ–π (`/app/embedding_models`) –ø—Ä–æ–±—Ä–æ—à–µ–Ω volume'–æ–º –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∏ –Ω–µ —Å–∫–∞—á–∏–≤–∞–ª–∏ –≤–µ—Å–∞ –∑–∞–Ω–æ–≤–æ.
- –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é Rag –∫–æ–Ω–Ω–µ–∫—Ç–∏—Ç—Å—è –∫ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ `knowledge base`. –ï—Å–ª–∏ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –Ω–µ—Ç, –æ–Ω–∞ —Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å—é 768 (all-mpnet-base-v2).
- Ollama –∏—Å–ø–æ–ª—å–∑—É–µ—Ç volume `./deploy/ollama_models`. –ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º —Å—Ç–æ–∏—Ç –ø–æ–¥—Ç—è–Ω—É—Ç—å –Ω—É–∂–Ω—É—é –º–æ–¥–µ–ª—å, –Ω–∞–ø—Ä–∏–º–µ—Ä `docker exec ollama ollama pull tinyllama:1.1b`.
- –í `docker-compose.yml` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **–≤–Ω–µ—à–Ω—è—è —Å–µ—Ç—å** `shared_network`. –ï—Å–ª–∏ –µ–µ –Ω–µ—Ç, —Å–æ–∑–¥–∞–π—Ç–µ: `docker network create shared_network`.

---

## –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker Compose

1. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**: Docker 24+, Docker Compose, –¥–æ—Å—Ç—É–ø –∫ Hugging Face (–Ω—É–∂–µ–Ω –∏–Ω—Ç–µ—Ä–Ω–µ—Ç –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –º–æ–¥–µ–ª–µ–π).
2. **–°–∫–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∏ –ø–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ**:
   ```bash
   git clone <repo_url>
   cd rag_llm
   cp .env.example .env  # –µ—Å–ª–∏ –µ—Å—Ç—å –ø—Ä–∏–º–µ—Ä, –ª–∏–±–æ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Ä—É—á–Ω—É—é
   ```
3. **–°–æ–∑–¥–∞–π—Ç–µ –≤–Ω–µ—à–Ω—é—é —Å–µ—Ç—å (–µ—Å–ª–∏ –Ω–µ —Å–æ–∑–¥–∞–Ω–∞):**
   ```bash
   docker network create shared_network
   ```
4. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–∏—Å—ã**:
   ```bash
   docker-compose up --build
   ```
   –ë—É–¥—É—Ç –ø–æ–¥–Ω—è—Ç—ã:
   - `ollama` ‚Äî –ª–æ–∫–∞–ª—å–Ω—ã–π —Ä–∞–Ω—Ç–∞–π–º LLM;
   - `open-webui` ‚Äî UI –ø–æ–≤–µ—Ä—Ö Ollama (–ø–æ –∂–µ–ª–∞–Ω–∏—é);
   - `qdrant` ‚Äî –≤–µ–∫—Ç–æ—Ä–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ (–ø–æ—Ä—Ç 6333);
   - `redis` ‚Äî –±—Ä–æ–∫–µ—Ä –æ—á–µ—Ä–µ–¥–µ–π;
   - `api` ‚Äî FastAPI + Rag;
   - `queue` ‚Äî –≤–æ—Ä–∫–µ—Ä –æ—á–µ—Ä–µ–¥–∏;
   - `telegram-bot` ‚Äî aiogram –±–æ—Ç (–ø–æ–ª–ª–∏–Ω–≥);
   - volume –∫–∞—Ç–∞–ª–æ–≥–∏ (data, embedding_models, qdrant_data, redis_data, ollama_models).

5. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ API**: `http://localhost:5005/docs`.

–ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –≤—Ä–µ–º—è –Ω–∞ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–µ–π –∏–∑ Hugging Face –∏ Ollama. –¢–∞–π–º–∞—É—Ç—ã —É–∂–µ —É–≤–µ–ª–∏—á–µ–Ω—ã –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ `HF_*`.

---

## –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫

Docker –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω. –ú–æ–∂–Ω–æ –ø–æ–¥–Ω—è—Ç—å —á–∞—Å—Ç–∏ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã –≤—Ä—É—á–Ω—É—é.

1. **Python –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**:
   ```bash
   python3 -m venv .venv
   source .venv/bin/activate
   pip install -r deploy/requirements.txt
   ```
2. **–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞**:
   ```bash
   docker run -d --name qdrant -p 6333:6333 -p 6334:6334 qdrant/qdrant
   docker run -d --name redis -p 6379:6379 redis:6.2.6
   # –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ ollama:
   docker run -d --name ollama -p 11434:11434 ollama/ollama
   ```
3. **–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è**: –∑–∞–ø–æ–ª–Ω–∏—Ç–µ `.env` –∏ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ, —á—Ç–æ–±—ã `app` z–Ω–∞–ª –ø—Ä–æ Qdrant, Redis –∏ –∫–ª—é—á–∏.
4. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ API**:
   ```bash
   uvicorn app.main:app --host 0.0.0.0 --port 5005 --reload
   ```
5. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –≤–æ—Ä–∫–µ—Ä –æ—á–µ—Ä–µ–¥–∏** (–≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ):
   ```bash
   python app/manage.py
   ```
6. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ Telegram-–±–æ—Ç–∞**:
   ```bash
   cd bot
   python main.py
   ```

–î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞ –±–µ–∑ Ollama —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `TYPE_MODEL=cloud` –∏ –ø–µ—Ä–µ–¥–∞–π—Ç–µ `OPENROUTER_API_KEY`.

---

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ API –∏ –æ—á–µ—Ä–µ–¥–µ–π

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è

```bash
curl http://localhost:5005/api/health
```
–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Qdrant –∏ —Ñ–∞–∫—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ LLM.

### –ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞ (–≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞/–æ–∫—Ä—É–∂–µ–Ω–∏—è)

```bash
curl -X POST "http://localhost:5005/api/index-local-project" \
     -H "accept: application/json" \
     -d "project_path=/app/data/my_project"
```
–ü—É—Ç—å —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ `api` –∏–ª–∏ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è. –ü–µ—Ä–µ–¥ –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–µ–π –∏—Å—Ç–æ—Ä–∏—è –¥–∏–∞–ª–æ–≥–∞ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤–µ–∫—Ç–æ—Ä–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑:
- `scan_dataset` ‚Üí `FileProcessorFacade.parse_file` (pdf/md/txt/html/python);
- `code_splitter` ‚Üí `Qdrant.add_documents`.

### –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –≤–æ–ø—Ä–æ—Å (–±–µ–∑ –æ—á–µ—Ä–µ–¥–∏)

```bash
curl -X POST "http://localhost:5005/api/ask_test" \
     -H "accept: application/json" \
     -d "question=–ß—Ç–æ –¥–µ–ª–∞–µ—Ç –∫–ª–∞—Å—Å Rag?"
```
–û—Ç–≤–µ—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–µ–∫—Å—Ç LLM, –æ–±—Ä–µ–∑–∞–Ω–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ (—Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã –¥–æ–∫—É–º–µ–Ω—Ç–∞) –∏ –∏—Å—Ç–æ—Ä–∏—é –¥–∏–∞–ª–æ–≥–∞.

### –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –≤–æ–ø—Ä–æ—Å (—á–µ—Ä–µ–∑ –æ—á–µ—Ä–µ–¥—å –∏ Telegram)

```bash
curl -X POST "http://localhost:5005/api/ask" \
     -H "accept: application/json" \
     -d "question=–û–ø–∏—à–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –ø—Ä–æ–µ–∫—Ç–∞" \
     -d "chat_id=<telegram_chat_id>"
```
–ó–∞–ø—Ä–æ—Å –∫–ª–∞–¥–µ—Ç—Å—è –≤ –æ—á–µ—Ä–µ–¥—å `rag_questions`. –í–æ—Ä–∫–µ—Ä (`app/manage.py`) –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –µ–≥–æ —Ñ—É–Ω–∫—Ü–∏–µ–π `services.rag_adapter.rag_ask_llm`, –ø–æ—Å–ª–µ —á–µ–≥–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ—Ç–≤–µ—Ç –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π Telegram-—á–∞—Ç —Å –ø–æ–º–æ—â—å—é `BOT_TOKEN`. –í API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ ¬´–ó–∞–ø—Ä–æ—Å –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –≤ –º–æ–¥–µ–ª—å¬ª.

---

## –¢–µ–ª–µ–≥—Ä–∞–º-–±–æ—Ç

- –ö–æ–¥: `bot/main.py`.
- –°—Ç–µ–∫: `aiogram 3`, `aiohttp`.
- –ö–æ–º–∞–Ω–¥—ã: `/start`, `/help`, –ª—é–±—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –≤ API (`/api/ask`).
- –ü–æ–≤–µ–¥–µ–Ω–∏–µ: –±–æ—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç `typing` action, –∂–¥–µ—Ç –æ—Ç–≤–µ—Ç –æ—Ç API –∏ –ø–µ—Ä–µ—Å—ã–ª–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é; –∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç—Å—è `aiogram` –∏ `aiohttp`.
- –ó–∞–ø—É—Å–∫ –≤ Docker: –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä `telegram-bot` –∑–∞–≤–∏—Å–∏—Ç –æ—Ç `api` –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `bot/.env` –¥–ª—è —Ç–æ–∫–µ–Ω–∞. –í –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –º–æ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è `./bot`.

–ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ—Ç–∞ –æ—Ç–¥–µ–ª—å–Ω–æ, —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (`pip install -r bot/deploy/requirements.txt`) –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ `python bot/main.py`, –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ —É–∫–∞–∑–∞–≤ `BOT_TOKEN` –∏ `API_BASE_URL`.

---

## –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è

–ú–æ–¥—É–ª—å `app/lib/file_processor.py` –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç —Ñ–∞–π–ª—ã –≤ –¥–æ–∫—É–º–µ–Ω—Ç—ã —Å –±–æ–≥–∞—Ç—ã–º–∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏:

- **PDF** (`PyPDF2`): –¥–æ–∫—É–º–µ–Ω—Ç—ã —Ü–µ–ª–∏–∫–æ–º + —Ä–∞–∑–±–∏–≤–∫–∞ –ø–æ —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º.
- **Markdown** (`markdown`, `re`): —Å–µ–∫—Ü–∏–∏, –∑–∞–≥–æ–ª–æ–≤–∫–∏, –±–ª–æ–∫–∏ –∫–æ–¥–∞.
- **–¢–µ–∫—Å—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã**: –∞–±–∑–∞—Ü—ã –∏ —Å–µ–∫—Ü–∏–∏, —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∫–æ—Ä–æ—Ç–∫–∏—Ö —Å—Ç—Ä–æ–∫.
- **HTML** (`BeautifulSoup4`): –æ—á–∏—â–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç, –∑–∞–≥–æ–ª–æ–≤–∫–∏, —Å–ø–∏—Å–∫–∏, —Ç–∞–±–ª–∏—Ü—ã, —Å—Å—ã–ª–∫–∏.
- **Python** (`ast`): –∫–ª–∞—Å—Å—ã –∏ —Ñ—É–Ω–∫—Ü–∏–∏ —Å –∏—Å—Ö–æ–¥–Ω—ã–º –∫–æ–¥–æ–º.

–í—Å–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã –ø—Ä–∏–≤–æ–¥—è—Ç—Å—è –∫ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–º –ø—É—Ç—è–º –∏ —Ö—Ä–∞–Ω—è—Ç —Ç–∏–ø (class/function/paragraph –∏ —Ç.–¥.), —á—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç –æ–±—ä—è—Å–Ω—è—Ç—å —Ç–æ—á–Ω–æ–µ –ø—Ä–æ–∏—Å—Ö–æ–∂–¥–µ–Ω–∏–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞ –≤ –æ—Ç–≤–µ—Ç–µ.

–ü–æ—Å–ª–µ –ø–∞—Ä—Å–∏–Ω–≥–∞ –¥–æ–∫—É–º–µ–Ω—Ç—ã —Ä–µ–∂—É—Ç—Å—è `RecursiveCharacterTextSplitter` (1000 —Å–∏–º–≤–æ–ª–æ–≤, –æ–≤–µ—Ä–ª–∞–ø 150) –∏ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤ Qdrant. –ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç —Å–∫—Ä—ã—Ç—ã–µ –∫–∞—Ç–∞–ª–æ–≥–∏ (`.git`, `__pycache__`) –∏ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ —Å—Ä–µ–¥—ã.

---

## –ö–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è

1. **LLM**: –≤ `services/dependencies.py` –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –º–æ–¥–µ–ª—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞ (`tinyllama:1.1b`). –î–ª—è –æ–±–ª–∞–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `TYPE_MODEL=cloud` –∏ –ø–µ—Ä–µ–¥–∞–π—Ç–µ `model` –≤ `rag.init_llm`.
2. **–≠–º–±–µ–¥–¥–∏–Ω–≥–∏**: –ø–∞—Ä–∞–º–µ—Ç—Ä `embeddings` –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞ Rag. –ú–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –ª—é–±–æ–π `sentence-transformers` (–Ω–µ –∑–∞–±—É–¥—å—Ç–µ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –≤ Qdrant).
3. **–†–∞–∑–º–µ—Ä —á–∞–Ω–∫–æ–≤**: –º–µ–Ω—è–µ—Ç—Å—è –≤ `Rag.code_splitter`. –£–≤–µ–ª–∏—á—å—Ç–µ `chunk_size` –¥–ª—è –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤.
4. **–û—á–µ—Ä–µ–¥–∏**: `QueueManager.run` –ø—Ä–∏–Ω–∏–º–∞–µ—Ç `queue_worker_cnt`, —Ç–∞–∫ —á—Ç–æ –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ –æ—á–µ—Ä–µ–¥–∏ –∏ —Ñ—É–Ω–∫—Ü–∏–∏.
5. **–§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞**: –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É–π—Ç–µ –ø—Ä–æ–º–ø—Ç `custom_prompt` –≤ `rag.init_llm`.
6. **–ò—Å—Ç–æ—Ä–∏—è –¥–∏–∞–ª–æ–≥–∞**: –≥–ª—É–±–∏–Ω—É –ø–∞–º—è—Ç–∏ –∑–∞–¥–∞–µ—Ç `ConversationBufferWindowMemory(k=6)`.
7. **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–æ–≤—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤**: –¥–æ–±–∞–≤—å—Ç–µ –ø–∞—Ä—Å–µ—Ä –≤ `FileProcessor.PARSER_MAPPING` –∏ —Ä–µ–∞–ª–∏–∑—É–π—Ç–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –∫–ª–∞—Å—Å.

---

## –¢—Ä–æ–±–ª—à—É—Ç–∏–Ω–≥

- **LLM –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è**: —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Ollama –∑–∞–ø—É—â–µ–Ω (–¥–ª—è `local`) –∏–ª–∏ –ø–µ—Ä–µ–¥–∞–Ω `OPENROUTER_API_KEY` –∏ –æ—Ç–∫—Ä—ã—Ç –∏–Ω—Ç–µ—Ä–Ω–µ—Ç (–¥–ª—è `cloud`). –õ–æ–≥–∏ `api` –ø–æ–¥—Å–∫–∞–∂—É—Ç –ø—Ä–∏—á–∏–Ω—É.
- **Qdrant ¬´disconnected¬ª**: –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ `QDRANT_HOST`, `QDRANT_PORT`, –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –∏ —Ç–æ, —á—Ç–æ –∫–æ–ª–ª–µ–∫—Ü–∏—è —Å–æ–∑–¥–∞–µ—Ç—Å—è (–≤ –ª–æ–≥–∞—Ö `api`).
- **–¢–∞–π–º–∞—É—Ç—ã Hugging Face**: —É–∂–µ –≤—ã—Å—Ç–∞–≤–ª–µ–Ω—ã `HF_HUB_DOWNLOAD_TIMEOUT` –∏ —Ç.–¥., –Ω–æ –µ—Å–ª–∏ –∑–µ—Ä–∫–∞–ª–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã, –º–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å `HF_ENDPOINT`.
- **–û—á–µ—Ä–µ–¥—å –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è**: –∑–∞–ø—É—â–µ–Ω –ª–∏ —Å–µ—Ä–≤–∏—Å `queue`? –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `docker-compose logs queue`. –ü—Ä–∏ –æ—à–∏–±–∫–∞—Ö –≤–æ—Ä–∫–µ—Ä –¥–µ–ª–∞–µ—Ç —Ä–µ—Ç—Ä–∞–∏ —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π 5 –º–∏–Ω—É—Ç.
- **–ë–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç**: —Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ `telegram-bot` –∏ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ API –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∏–º–µ–Ω–∏ `api` –≤–Ω—É—Ç—Ä–∏ —Å–µ—Ç–∏ –ª–∏–±–æ –∑–∞–¥–∞–π—Ç–µ `API_BASE_URL`.
- **–ö–æ–ª–ª–µ–∫—Ü–∏—è —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç**: –ª–æ–≥–∏–∫–∞ Rag –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–ø–∏—Å–æ–∫ –∫–æ–ª–ª–µ–∫—Ü–∏–π; –ø—Ä–∏ –æ—à–∏–±–∫–µ —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–µ–∫—É—â–∞—è.

---

## FAQ

**Q:** –ö–∞–∫ –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å –ø–æ–∏—Å–∫ —Ç–æ–ª—å–∫–æ –∫–æ–¥–æ–≤—ã–º–∏ —Ñ–∞–π–ª–∞–º–∏?  
**A:** –ü–µ—Ä–µ–¥–∞–π—Ç–µ `file_extensions=['.py']` –≤ `scan_dataset`. –ú–æ–∂–Ω–æ –æ–±–µ—Ä–Ω—É—Ç—å –º–µ—Ç–æ–¥ –≤ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–µ—Ä–≤–∏—Å –∏–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å –∞—Ä–≥—É–º–µ–Ω—Ç –≤ —ç–Ω–¥–ø–æ–∏–Ω—Ç.

**Q:** –ú–æ–∂–Ω–æ –ª–∏ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ—á–µ—Ä–µ–¥–∏ –≤ –¥—Ä—É–≥–æ–π —Å–µ—Ä–≤–∏—Å, –∞ –Ω–µ –≤ Telegram?  
**A:** –î–∞. `services/rag_adapter.rag_ask_llm` ‚Äî –æ–±—ã—á–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è. –ó–∞–º–µ–Ω–∏—Ç–µ –±–ª–æ–∫ —Å `requests.post` –Ω–∞ –Ω—É–∂–Ω—É—é –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é.

**Q:** –ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é –æ—á–µ—Ä–µ–¥—å?  
**A:** –°–æ–∑–¥–∞–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é, –∏–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –µ–µ —á–µ—Ä–µ–∑ `function_path` –≤ `queue.add` –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –≤–æ—Ä–∫–µ—Ä —Å `queue_worker_cnt={"my_queue": <n>}`.

**Q:** –ú–æ–∂–Ω–æ –ª–∏ –∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞—Ç—å —É–¥–∞–ª–µ–Ω–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π?  
**A:** –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ –µ–≥–æ –≤ `deploy/data/<project>` –∏–ª–∏ –ø—Ä–æ–±—Ä–æ—Å—å—Ç–µ volume –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä `api`, –∑–∞—Ç–µ–º –≤—ã–∑–æ–≤–∏—Ç–µ `/api/index-local-project`.

**Q:** –ö–∞–∫–∏–µ —Ç–æ–∫–µ–Ω—ã –Ω—É–∂–Ω—ã –±–æ—Ç—É?  
**A:** –¢–æ–ª—å–∫–æ `BOT_TOKEN`. Chat ID –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ API –ø—Ä–∏ –≤—ã–∑–æ–≤–µ `/api/ask` –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–æ—Ä–∫–µ—Ä–æ–º –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏.

---

–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å —É–ª—É—á—à–µ–Ω–∏—è –∏–ª–∏ –∏–¥–µ–∏, —Å–æ–∑–¥–∞–π—Ç–µ Issue / Pull Request. –£–¥–∞—á–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤! üí°
